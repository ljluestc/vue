<scriptsrc="../../dist/vue.min.js"></script><linkrel="stylesheet"href="../../node_modules/todomvc-app-css/index.css"/><divid="app"><sectionclass="todoapp"><headerclass="header"><h1>todos</h1><inputclass="new-todo"autofocusautocomplete="off"placeholder="Whatneedstobedone?"v-model="state.newTodo"@keyup.enter="addTodo"/></header><sectionclass="main"v-show="state.todos.length"><inputid="toggle-all"class="toggle-all"type="checkbox"v-model="state.allDone"/><labelfor="toggle-all">Markallascomplete</label><ulclass="todo-list"><liv-for="todoinstate.filteredTodos"class="todo":key="todo.id":class="{completed:todo.completed,editing:todo===state.editedTodo}"><divclass="view"><inputclass="toggle"type="checkbox"v-model="todo.completed"/><label@dblclick="editTodo(todo)">{{todo.title}}</label><buttonclass="destroy"@click="removeTodo(todo)"></button></div><inputclass="edit"type="text"v-model="todo.title"v-todo-focus="todo===state.editedTodo"@blur="doneEdit(todo)"@keyup.enter="doneEdit(todo)"@keyup.escape="cancelEdit(todo)"/></li></ul></section><footerclass="footer"v-show="state.todos.length"><spanclass="todo-count"><strong>{{state.remaining}}</strong><span>{{state.remainingText}}</span></span><ulclass="filters"><li><ahref="#/all":class="{selected:state.visibility==='all'}">All</a></li><li><ahref="#/active":class="{selected:state.visibility==='active'}">Active</a></li><li><ahref="#/completed":class="{selected:state.visibility==='completed'}">Completed</a></li></ul><buttonclass="clear-completed"@click="removeCompleted"v-show="state.todos.length>state.remaining">Clearcompleted</button></footer></section></div><script>const{reactive,computed,watchEffect,onMounted,onUnmounted}=VueconstSTORAGE_KEY='todos-vuejs-3.x-composition'consttodoStorage={fetch(){consttodos=JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]')todos.forEach((todo,index)=>{todo.id=index})todoStorage.uid=todos.lengthreturntodos},save(todos){localStorage.setItem(STORAGE_KEY,JSON.stringify(todos))}}constfilters={all(todos){returntodos},active(todos){returntodos.filter(todo=>{return!todo.completed})},completed(todos){returntodos.filter(function(todo){returntodo.completed})}}functionpluralize(n){returnn===1?'item':'items'}newVue({setup(){conststate=reactive({todos:todoStorage.fetch(),editedTodo:null,newTodo:'',beforeEditCache:'',visibility:'all',remaining:computed(()=>{returnfilters.active(state.todos).length}),remainingText:computed(()=>{return`${pluralize(state.remaining)}left`}),filteredTodos:computed(()=>{returnfilters[state.visibility](state.todos)}),allDone:computed({get:function(){returnstate.remaining===0},set:function(value){state.todos.forEach(todo=>{todo.completed=value})}})})watchEffect(()=>{todoStorage.save(state.todos)})onMounted(()=>{window.addEventListener('hashchange',onHashChange)onHashChange()})onUnmounted(()=>{window.removeEventListener('hashchange',onHashChange)})functiononHashChange(){constvisibility=window.location.hash.replace(/#\/?/,'')if(filters[visibility]){state.visibility=visibility}else{window.location.hash=''state.visibility='all'}}functionaddTodo(){constvalue=state.newTodo&&state.newTodo.trim()if(!value){return}state.todos.push({id:todoStorage.uid++,title:value,completed:false})state.newTodo=''}functionremoveTodo(todo){state.todos.splice(state.todos.indexOf(todo),1)}functioneditTodo(todo){state.beforeEditCache=todo.titlestate.editedTodo=todo}functiondoneEdit(todo){if(!state.editedTodo){return}state.editedTodo=nulltodo.title=todo.title.trim()if(!todo.title){removeTodo(todo)}}functioncancelEdit(todo){state.editedTodo=nulltodo.title=state.beforeEditCache}functionremoveCompleted(){state.todos=filters.active(state.todos)}return{state,addTodo,removeTodo,editTodo,doneEdit,cancelEdit,removeCompleted}},directives:{'todo-focus':(el,{value})=>{if(value){el.focus()}}}}).$mount('#app')</script>