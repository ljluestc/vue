importVue,{VNode,VNodeDirective}from'../../../types/index'importVueSSRClientPluginfrom'../client-plugin'importVueSSRServerPluginfrom'../server-plugin'importwebpackfrom'webpack'import{readFileSync}from'fs'import{createRenderer,createBundleRenderer}from'.'functioncreateApp(context:any){returnnewVue({data:{url:context.url},template:`<div>ThevisitedURLis:{{url}}</div>`})}Renderertestconstapp=createApp({url:'http:localhost:8000/'})constrenderer=createRenderer({template:readFileSync('./index.template.html','utf-8')})constcontext={title:'Hello',meta:`<metaname="description"content="Vue.jsSSRExample">`}renderer.renderToString(app,(err,html)=>{if(err)throwerrconstres:string=html})renderer.renderToString(app,context,(err,html)=>{if(err)throwerrconstres:string=html})renderer.renderToString(app).then(html=>{constres:string=html}).catch(err=>{throwerr})renderer.renderToString(app,context).then(html=>{constres:string=html}).catch(err=>{throwerr})renderer.renderToStream(app,context).on('data',chunk=>{consthtml=chunk.toString()})BundlerenderertestdeclareconstcacheClient:{[key:string]:string}constbundleRenderer=createBundleRenderer('/path/to/vue-ssr-server-bundle.json',{inject:false,runInNewContext:'once',basedir:'/path/to/base',shouldPreload:(file,type)=>{if(type==='script'||type==='style'){returntrue}if(type==='font'){return/\.woff2$/.test(file)}if(type==='image'){returnfile==='hero.jpg'}returnfalse},cache:{get:key=>{returncacheClient[key]},set:(key,val)=>{cacheClient[key]=val},has:key=>{return!!cacheClient[key]}},directives:{example(vnode:VNode,directiveMeta:VNodeDirective){transformvnodebasedondirectivebindingmetadata}}})bundleRenderer.renderToString(context,(err,html)=>{if(err)throwerrconstres:string=html})bundleRenderer.renderToString().then(html=>{constres:string=html})bundleRenderer.renderToString(context).then(html=>{constres:string=html})bundleRenderer.renderToStream(context).on('data',chunk=>{consthtml=chunk.toString()})webpackpluginswebpack({plugins:[newVueSSRClientPlugin({filename:'client-manifest.json'}),newVueSSRServerPlugin({filename:'server-bundle.json'})]})