import{looseEqual,looseIndexOf}from'shared/util'importtype{VNodeDirective,VNodeWithData}from'types/vnode'//thisisonlyappliedfor<selectv-model>becauseitistheonlyedgecase//thatmustbedoneatruntimeinsteadofcompiletime.exportdefaultfunctionmodel(node:VNodeWithData,dir:VNodeDirective){if(!node.children)returnconstvalue=dir.valueconstisMultiple=node.data.attrs&&node.data.attrs.multiplefor(leti=0,l=node.children.length;i<l;i++){constoption=node.children[i]if(option.tag==='option'){if(isMultiple){constselected=Array.isArray(value)&&looseIndexOf(value,getValue(option))>-1if(selected){setSelected(option)}}else{if(looseEqual(value,getValue(option))){setSelected(option)return}}}}}functiongetValue(option){constdata=option.data||{}return((data.attrs&&data.attrs.value)||(data.domProps&&data.domProps.value)||(option.children&&option.children[0]&&option.children[0].text))}functionsetSelected(option){constdata=option.data||(option.data={})constattrs=data.attrs||(data.attrs={})attrs.selected=''}