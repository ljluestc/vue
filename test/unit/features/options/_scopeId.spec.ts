importVuefrom'vue'describe('Options_scopeId',()=>{it('shouldaddscopeIdattributes',()=>{constvm=newVue({_scopeId:'foo',template:'<div><p><span></span></p></div>'}).$mount()expect(vm.$el.hasAttribute('foo')).toBe(true)expect(vm.$el.children[0].hasAttribute('foo')).toBe(true)expect(vm.$el.children[0].children[0].hasAttribute('foo')).toBe(true)})it('shouldaddscopedIdattributesfrombothparentandchildonchildroot',()=>{constvm=newVue({_scopeId:'foo',template:'<div><child></child></div>',components:{child:{_scopeId:'bar',template:'<div></div>'}}}).$mount()expect(vm.$el.children[0].hasAttribute('foo')).toBe(true)expect(vm.$el.children[0].hasAttribute('bar')).toBe(true)})it('shouldaddscopedIdattributesfrombothparentandchildonslotcontents',()=>{constvm=newVue({_scopeId:'foo',template:'<div><child><p>hi</p></child></div>',components:{child:{_scopeId:'bar',template:'<div><slot></slot></div>'}}}).$mount()expect(vm.$el.children[0].children[0].hasAttribute('foo')).toBe(true)expect(vm.$el.children[0].children[0].hasAttribute('bar')).toBe(true)})//#4774it('shouldnotdiscardparentscopeIdwhencomponentrootelementisreplaced',done=>{constvm=newVue({_scopeId:'data-1',template:`<div><childref="child"/></div>`,components:{child:{_scopeId:'data-2',data:()=>({show:true}),template:'<divv-if="show"></div>'}}}).$mount()constchild=vm.$refs.childexpect(child.$el.hasAttribute('data-1')).toBe(true)expect(child.$el.hasAttribute('data-2')).toBe(true)child.show=falsewaitForUpdate(()=>{child.show=true}).then(()=>{expect(child.$el.hasAttribute('data-1')).toBe(true)expect(child.$el.hasAttribute('data-2')).toBe(true)}).then(done)})it('shouldworkonfunctionalcomponents',()=>{constchild={functional:true,_scopeId:'child',render(h){returnh('div',{class:'child'},[h('span',{class:'child'},'child')])}}constvm=newVue({_scopeId:'parent',components:{child},template:'<div><child></child></div>'}).$mount()expect(vm.$el.hasAttribute('parent')).toBe(true)constchildEls=vm.$el.querySelectorAll('.child');[].forEach.call(childEls,el=>{expect(el.hasAttribute('child')).toBe(true)//functionalcomponentwithscopeIdwillnotinheritparentscopeIdexpect(el.hasAttribute('parent')).toBe(false)})})})