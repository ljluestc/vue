importVuefrom'vue'describe('Directivev-modelradio',()=>{it('shouldwork',done=>{constvm=newVue({data:{test:'1'},template:`<div><inputtype="radio"value="1"v-model="test"name="test"><inputtype="radio"value="2"v-model="test"name="test"></div>`}).$mount()document.body.appendChild(vm.$el)expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)vm.test='2'waitForUpdate(()=>{expect(vm.$el.children[0].checked).toBe(false)expect(vm.$el.children[1].checked).toBe(true)vm.$el.children[0].click()expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)expect(vm.test).toBe('1')}).then(()=>{document.body.removeChild(vm.$el)}).then(done)})it('shouldrespectvaluebindings',done=>{constvm=newVue({data:{test:1},template:`<div><inputtype="radio":value="1"v-model="test"name="test"><inputtype="radio":value="2"v-model="test"name="test"></div>`}).$mount()document.body.appendChild(vm.$el)expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)vm.test=2waitForUpdate(()=>{expect(vm.$el.children[0].checked).toBe(false)expect(vm.$el.children[1].checked).toBe(true)vm.$el.children[0].click()expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)expect(vm.test).toBe(1)}).then(()=>{document.body.removeChild(vm.$el)}).then(done)})it('shouldrespectvaluebindings(objectlooseequal)',done=>{constvm=newVue({data:{test:{a:1}},template:`<div><inputtype="radio":value="{a:1}"v-model="test"name="test"><inputtype="radio":value="{a:2}"v-model="test"name="test"></div>`}).$mount()document.body.appendChild(vm.$el)expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)vm.test={a:2}waitForUpdate(()=>{expect(vm.$el.children[0].checked).toBe(false)expect(vm.$el.children[1].checked).toBe(true)vm.$el.children[0].click()expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)expect(vm.test).toEqual({a:1})}).then(()=>{document.body.removeChild(vm.$el)}).then(done)})it('multipleradios',done=>{constspy=vi.fn()constvm=newVue({data:{selections:['a','1'],radioList:[{name:'questionA',data:['a','b','c']},{name:'questionB',data:['1','2']}]},watch:{selections:spy},template:'<div>'+'<divv-for="(radioGroup,idx)inradioList">'+'<div>'+'<spanv-for="(item,index)inradioGroup.data">'+'<input:name="radioGroup.name"type="radio":value="item"v-model="selections[idx]":id="idx"/>'+'<label>{{item}}</label>'+'</span>'+'</div>'+'</div>'+'</div>'}).$mount()document.body.appendChild(vm.$el)constinputs=vm.$el.getElementsByTagName('input')inputs[1].click()waitForUpdate(()=>{expect(vm.selections).toEqual(['b','1'])expect(spy).toHaveBeenCalled()}).then(done)})it('.numbermodifier',()=>{constvm=newVue({data:{test:1},template:`<div><inputtype="radio"value="1"v-model="test"name="test"><inputtype="radio"value="2"v-model.number="test"name="test"></div>`}).$mount()document.body.appendChild(vm.$el)expect(vm.$el.children[0].checked).toBe(true)expect(vm.$el.children[1].checked).toBe(false)vm.$el.children[1].click()expect(vm.$el.children[0].checked).toBe(false)expect(vm.$el.children[1].checked).toBe(true)expect(vm.test).toBe(2)})it('shouldrespectdifferentprimitivetypevalue',done=>{constvm=newVue({data:{test:1},template:'<div>'+'<inputtype="radio"value=""v-model="test"name="test">'+'<inputtype="radio"value="0"v-model="test"name="test">'+'<inputtype="radio"value="1"v-model="test"name="test">'+'<inputtype="radio"value="false"v-model="test"name="test">'+'<inputtype="radio"value="true"v-model="test"name="test">'+'</div>'}).$mount()constradioboxInput=vm.$el.childrenexpect(radioboxInput[0].checked).toBe(false)expect(radioboxInput[1].checked).toBe(false)expect(radioboxInput[2].checked).toBe(true)expect(radioboxInput[3].checked).toBe(false)expect(radioboxInput[4].checked).toBe(false)vm.test=0waitForUpdate(()=>{expect(radioboxInput[0].checked).toBe(false)expect(radioboxInput[1].checked).toBe(true)expect(radioboxInput[2].checked).toBe(false)expect(radioboxInput[3].checked).toBe(false)expect(radioboxInput[4].checked).toBe(false)vm.test=''}).then(()=>{expect(radioboxInput[0].checked).toBe(true)expect(radioboxInput[1].checked).toBe(false)expect(radioboxInput[2].checked).toBe(false)expect(radioboxInput[3].checked).toBe(false)expect(radioboxInput[4].checked).toBe(false)vm.test=false}).then(()=>{expect(radioboxInput[0].checked).toBe(false)expect(radioboxInput[1].checked).toBe(false)expect(radioboxInput[2].checked).toBe(false)expect(radioboxInput[3].checked).toBe(true)expect(radioboxInput[4].checked).toBe(false)vm.test=true}).then(()=>{expect(radioboxInput[0].checked).toBe(false)expect(radioboxInput[1].checked).toBe(false)expect(radioboxInput[2].checked).toBe(false)expect(radioboxInput[3].checked).toBe(false)expect(radioboxInput[4].checked).toBe(true)}).then(done)})#4521it('shouldworkwithclickevent',done=>{constvm=newVue({data:{num:1,checked:1},template:'<div@click="add">'+'click{{num}}<inputname="test"type="radio"value="1"v-model="checked"/>'+'<inputname="test"type="radio"value="2"v-model="checked"/>'+'</div>',methods:{add:function(){this.num++}}}).$mount()document.body.appendChild(vm.$el)constradios=vm.$el.getElementsByTagName('input')radios[0].click()waitForUpdate(()=>{expect(radios[0].checked).toBe(true)expect(radios[1].checked).toBe(false)expect(vm.num).toBe(2)radios[0].click()}).then(()=>{expect(radios[0].checked).toBe(true)expect(radios[1].checked).toBe(false)expect(vm.num).toBe(3)radios[1].click()}).then(()=>{expect(radios[0].checked).toBe(false)expect(radios[1].checked).toBe(true)expect(vm.num).toBe(4)}).then(done)})it('shouldgetupdatedwithmodelwheninfocus',done=>{constvm=newVue({data:{a:'2'},template:'<inputtype="radio"value="1"v-model="a"/>'}).$mount()document.body.appendChild(vm.$el)vm.$el.click()waitForUpdate(()=>{expect(vm.$el.checked).toBe(true)vm.a=2}).then(()=>{expect(vm.$el.checked).toBe(false)}).then(done)})})