importVuefrom'vue'describe('GlobalAPI:set/delete',()=>{describe('Vue.set',()=>{it('shouldupdateavueobject',done=>{constvm=newVue({template:'<div>{{x}}</div>',data:{x:1}}).$mount()expect(vm.$el.innerHTML).toBe('1')Vue.set(vm,'x',2)waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('2')}).then(done)})it('shouldupdateanobservingobject',done=>{constvm=newVue({template:'<div>{{foo.x}}</div>',data:{foo:{x:1}}}).$mount()expect(vm.$el.innerHTML).toBe('1')Vue.set(vm.foo,'x',2)waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('2')}).then(done)})it('shouldupdateanobservingarray',done=>{constvm=newVue({template:'<div><divv-for="v,kinlist">{{k}}-{{v}}</div></div>',data:{list:['a','b','c']}}).$mount()expect(vm.$el.innerHTML).toBe('<div>0-a</div><div>1-b</div><div>2-c</div>')Vue.set(vm.list,1,'d')waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('<div>0-a</div><div>1-d</div><div>2-c</div>')Vue.set(vm.list,'2','e')}).then(()=>{expect(vm.$el.innerHTML).toBe('<div>0-a</div><div>1-d</div><div>2-e</div>')/*eslint-disableno-new-wrappers*/Vue.set(vm.list,newNumber(1),'f')}).then(()=>{expect(vm.$el.innerHTML).toBe('<div>0-a</div><div>1-f</div><div>2-e</div>')Vue.set(vm.list,'3g','g')}).then(()=>{expect(vm.$el.innerHTML).toBe('<div>0-a</div><div>1-f</div><div>2-e</div>')}).then(done)})it('shouldupdateavueobjectwithnothing',done=>{constvm=newVue({template:'<div>{{x}}</div>',data:{x:1}}).$mount()expect(vm.$el.innerHTML).toBe('1')Vue.set(vm,'x',null)waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('')Vue.set(vm,'x')}).then(()=>{expect(vm.$el.innerHTML).toBe('')}).then(done)})it('beabletousestringtypeindexinarray',done=>{constvm=newVue({template:'<div><pv-for="objinlists">{{obj.name}}</p></div>',data:{lists:[{name:'A'},{name:'B'},{name:'C'}]}}).$mount()expect(vm.$el.innerHTML).toBe('<p>A</p><p>B</p><p>C</p>')Vue.set(vm.lists,'0',{name:'D'})waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('<p>D</p><p>B</p><p>C</p>')}).then(done)})//#6845it('shouldnotoverwritepropertiesonprototypechain',()=>{classModel{_bar?:stringconstructor(){this._bar=null}getbar(){returnthis._bar}setbar(newvalue){this._bar=newvalue}}constvm=newVue({data:{data:newModel()}})Vue.set(vm.data,'bar',123)expect(vm.data.bar).toBe(123)expect(vm.data.hasOwnProperty('bar')).toBe(false)expect(vm.data._bar).toBe(123)})})describe('Vue.delete',()=>{it('shoulddeleteakey',done=>{constvm=newVue({template:'<div>{{obj.x}}</div>',data:{obj:{x:1}}}).$mount()expect(vm.$el.innerHTML).toBe('1')vm.obj.x=2waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('2')Vue.delete(vm.obj,'x')}).then(()=>{expect(vm.$el.innerHTML).toBe('')vm.obj.x=3}).then(()=>{expect(vm.$el.innerHTML).toBe('')}).then(done)})it('beabletodeleteaniteminarray',done=>{constvm=newVue({template:'<div><pv-for="objinlists">{{obj.name}}</p></div>',data:{lists:[{name:'A'},{name:'B'},{name:'C'}]}}).$mount()expect(vm.$el.innerHTML).toBe('<p>A</p><p>B</p><p>C</p>')Vue.delete(vm.lists,1)waitForUpdate(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,NaN)}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,-1)}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,'1.3')}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,true)}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,{})}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p><p>C</p>')Vue.delete(vm.lists,'1')}).then(()=>{expect(vm.$el.innerHTML).toBe('<p>A</p>')/*eslint-disableno-new-wrappers*/Vue.delete(vm.lists,newNumber(0)asnumber)}).then(()=>{expect(vm.$el.innerHTML).toBe('')}).then(done)})})})