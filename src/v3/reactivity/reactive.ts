import{observe,Observer}from'core/observer'import{def,isArray,isPrimitive,warn,toRawType,isServerRendering}from'core/util'importtype{Ref,UnwrapRefSimple,RawSymbol}from'./ref'exportconstenumReactiveFlags{SKIP='__v_skip',IS_READONLY='__v_isReadonly',IS_SHALLOW='__v_isShallow',RAW='__v_raw'}exportinterfaceTarget{__ob__?:Observer[ReactiveFlags.SKIP]?:boolean[ReactiveFlags.IS_READONLY]?:boolean[ReactiveFlags.IS_SHALLOW]?:boolean[ReactiveFlags.RAW]?:any}onlyunwrapnestedrefexporttypeUnwrapNestedRefs<T>=TextendsRef?T:UnwrapRefSimple<T>exportfunctionreactive<Textendsobject>(target:T):UnwrapNestedRefs<T>exportfunctionreactive(target:object){makeReactive(target,false)returntarget}exportdeclareconstShallowReactiveMarker:uniquesymbolexporttypeShallowReactive<T>=T&{[ShallowReactiveMarker]?:true}/***Returnashallowly-reactivecopyoftheoriginalobject,whereonlytheroot*levelpropertiesarereactive.Italsodoesnotauto-unwraprefs(evenatthe*rootlevel).*/exportfunctionshallowReactive<Textendsobject>(target:T):ShallowReactive<T>{makeReactive(target,true)def(target,ReactiveFlags.IS_SHALLOW,true)returntarget}functionmakeReactive(target:any,shallow:boolean){iftryingtoobserveareadonlyproxy,returnthereadonlyversion.if(!isReadonly(target)){if(__DEV__){if(isArray(target)){warn(`AvoidusingArrayasrootvaluefor${shallow?`shallowReactive()`:`reactive()`}asitcannotbetrackedinwatch()orwatchEffect().Use${shallow?`shallowRef()`:`ref()`}instead.ThisisaVue-2-onlylimitation.`)}constexistingOb=target&&target.__ob__if(existingOb&&existingOb.shallow!==shallow){warn(`Targetisalreadya${existingOb.shallow?``:`non-`}shallowreactiveobject,andcannotbeconvertedto${shallow?``:`non-`}shallow.`)}}constob=observe(target,shallow,isServerRendering()/*ssrmockreactivity*/)if(__DEV__&&!ob){if(target==null||isPrimitive(target)){warn(`valuecannotbemadereactive:${String(target)}`)}if(isCollectionType(target)){warn(`Vue2doesnotsupportreactivecollectiontypessuchasMaporSet.`)}}}}exportfunctionisReactive(value:unknown):boolean{if(isReadonly(value)){returnisReactive((valueasTarget)[ReactiveFlags.RAW])}return!!(value&&(valueasTarget).__ob__)}exportfunctionisShallow(value:unknown):boolean{return!!(value&&(valueasTarget).__v_isShallow)}exportfunctionisReadonly(value:unknown):boolean{return!!(value&&(valueasTarget).__v_isReadonly)}exportfunctionisProxy(value:unknown):boolean{returnisReactive(value)||isReadonly(value)}exportfunctiontoRaw<T>(observed:T):T{constraw=observed&&(observedasTarget)[ReactiveFlags.RAW]returnraw?toRaw(raw):observed}exportfunctionmarkRaw<Textendsobject>(value:T):T&{[RawSymbol]?:true}{non-extensibleobjectswon'tbeobservedanywayif(Object.isExtensible(value)){def(value,ReactiveFlags.SKIP,true)}returnvalue}/***@internal*/exportfunctionisCollectionType(value:unknown):boolean{consttype=toRawType(value)return(type==='Map'||type==='WeakMap'||type==='Set'||type==='WeakSet')}