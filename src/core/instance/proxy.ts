/*nottypecheckingthisfilebecauseflowdoesn'tplaywellwithProxy*/importconfigfrom'core/config'import{warn,makeMap,isNative}from'../util/index'letinitProxyif(__DEV__){constallowedGlobals=makeMap('Infinity,undefined,NaN,isFinite,isNaN,'+'parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,'+'Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,'+'require'//forWebpack/Browserify)constwarnNonPresent=(target,key)=>{warn(`Propertyormethod"${key}"isnotdefinedontheinstancebut`+'referencedduringrender.Makesurethatthispropertyisreactive,'+'eitherinthedataoption,orforclass-basedcomponents,by'+'initializingtheproperty.'+'See:https://v2.vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.',target)}constwarnReservedPrefix=(target,key)=>{warn(`Property"${key}"mustbeaccessedwith"$data.${key}"because`+'propertiesstartingwith"$"or"_"arenotproxiedintheVueinstanceto'+'preventconflictswithVueinternals.'+'See:https://v2.vuejs.org/v2/api/#data',target)}consthasProxy=typeofProxy!=='undefined'&&isNative(Proxy)if(hasProxy){constisBuiltInModifier=makeMap('stop,prevent,self,ctrl,shift,alt,meta,exact')config.keyCodes=newProxy(config.keyCodes,{set(target,key:string,value){if(isBuiltInModifier(key)){warn(`Avoidoverwritingbuilt-inmodifierinconfig.keyCodes:.${key}`)returnfalse}else{target[key]=valuereturntrue}}})}consthasHandler={has(target,key){consthas=keyintargetconstisAllowed=allowedGlobals(key)||(typeofkey==='string'&&key.charAt(0)==='_'&&!(keyintarget.$data))if(!has&&!isAllowed){if(keyintarget.$data)warnReservedPrefix(target,key)elsewarnNonPresent(target,key)}returnhas||!isAllowed}}constgetHandler={get(target,key){if(typeofkey==='string'&&!(keyintarget)){if(keyintarget.$data)warnReservedPrefix(target,key)elsewarnNonPresent(target,key)}returntarget[key]}}initProxy=functioninitProxy(vm){if(hasProxy){//determinewhichproxyhandlertouseconstoptions=vm.$optionsconsthandlers=options.render&&options.render._withStripped?getHandler:hasHandlervm._renderProxy=newProxy(vm,handlers)}else{vm._renderProxy=vm}}}export{initProxy}