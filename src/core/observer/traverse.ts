import{_SetasSet,isObject,isArray}from'../util/index'importtype{SimpleSet}from'../util/index'importVNodefrom'../vdom/vnode'import{isRef}from'../../v3'constseenObjects=newSet()/***Recursivelytraverseanobjecttoevokeallconverted*getters,sothateverynestedpropertyinsidetheobject*iscollectedasa"deep"dependency.*/exportfunctiontraverse(val:any){_traverse(val,seenObjects)seenObjects.clear()returnval}function_traverse(val:any,seen:SimpleSet){leti,keysconstisA=isArray(val)if((!isA&&!isObject(val))||val.__v_skip/*ReactiveFlags.SKIP*/||Object.isFrozen(val)||valinstanceofVNode){return}if(val.__ob__){constdepId=val.__ob__.dep.idif(seen.has(depId)){return}seen.add(depId)}if(isA){i=val.lengthwhile(i--)_traverse(val[i],seen)}elseif(isRef(val)){_traverse(val.value,seen)}else{keys=Object.keys(val)i=keys.lengthwhile(i--)_traverse(val[keys[i]],seen)}}